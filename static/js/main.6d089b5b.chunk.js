(this["webpackJsonpcareful-reader-app"]=this["webpackJsonpcareful-reader-app"]||[]).push([[0],{37:function(e,t,n){},40:function(e,t,n){e.exports=n.p+"static/media/back.c42ae1ad.svg"},41:function(e,t,n){e.exports=n.p+"static/media/home.3e06a93b.svg"},44:function(e,t,n){e.exports=n.p+"static/media/login.e51f7b8a.svg"},45:function(e,t,n){e.exports=n.p+"static/media/logout.92415547.svg"},46:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAN11AADddQGsh8ODAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAvpQTFRF////AQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACAQACBJYviwAAAP10Uk5TAAECAwQFBgcICQoL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"},48:function(e,t,n){e.exports=n.p+"static/media/book-shelf.60dcdcf8.png"},60:function(e,t,n){e.exports=n(80)},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(39),A=n.n(s),l=n(1),o=n.n(l),c=n(3);n(66),n(67);function i(e){var t=e.label,n=e.name,a=e.value,s=e.onChange;return r.a.createElement("label",null,r.a.createElement("span",null,t),r.a.createElement("input",{type:"checkbox",name:n,checked:a,value:"1",onChange:s}))}n(68);var u=n(6),f=n(7),x=n(15),p=n(40),m=n.n(p),d=n(41),b=n.n(d);n(37);function g(){var e=Object(f.g)(),t=Object(f.f)();return r.a.createElement(r.a.Fragment,null,!("/"===e.pathname)&&r.a.createElement("div",{className:"back-button",onClick:function(){return t.goBack()}},r.a.createElement("img",{src:m.a,alt:""})))}function h(){var e=Object(f.g)();return r.a.createElement(r.a.Fragment,null,!("/"===e.pathname)&&r.a.createElement(x.b,{className:"home-button",to:"/"},r.a.createElement("img",{src:b.a,alt:""})))}var v=n(12),C=n(42),Q=n(43),w=function(){function e(){Object(C.a)(this,e),this.googleDriveAPIDocument="https://www.googleapis.com/discovery/v1/apis/drive/v3/rest",this.scope="https://www.googleapis.com/auth/drive.appfolder",this.isGAPILoaded=!1}return Object(Q.a)(e,[{key:"load",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadGoogleAPI();case 2:return this.isGAPILoaded=!0,e.abrupt("return",new Promise((function(e,n){return window.gapi.client.drive?e():window.gapi.client.init({apiKey:"AIzaSyCPUP5x1qzZKw0KqVvyKt7tH8EiK_8HUxY",clientId:"200803973510-oejcrm8bu57ai7gb5tt1h3hkff4ju49r.apps.googleusercontent.com",discoveryDocs:[t.googleDriveAPIDocument],scope:t.scope}).then(e).catch(n)})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signIn",value:function(){try{return window.gapi.auth2.getAuthInstance().signIn()}catch(e){return this.processError(e)}}},{key:"signOut",value:function(){try{return window.gapi.auth2.getAuthInstance().signOut()}catch(e){return this.processError(e)}}},{key:"isLoggedIn",value:function(){return this.isGAPILoaded&&window.gapi.auth2.getAuthInstance()&&window.gapi.auth2.getAuthInstance().isSignedIn.get()}},{key:"list",value:function(){var e=Object(c.a)(o.a.mark((function e(){var t,n,a,r,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=s.length>0&&void 0!==s[0]?s[0]:"",n=[],e.prev=2;case 3:return e.next=5,this.callGapi(window.gapi.client.drive.files.list,{spaces:"appDataFolder",fields:"*",pageSize:100,pageToken:a,orderBy:"createdTime",q:t});case 5:r=e.sent,n=n.concat(r.result.files),a=r.result.nextPageToken;case 8:if(a){e.next=3;break}case 9:return e.abrupt("return",n);case 12:return e.prev=12,e.t0=e.catch(2),this.processError(e.t0),e.abrupt("return",n);case 16:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"listFolders",value:function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.list("mimeType = 'application/vnd.google-apps.folder'");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.callGapi(gapi.client.request,{path:"/upload/drive/v3/files/".concat(t),method:"PATCH",params:{uploadType:"media"},body:"string"===typeof n?n:JSON.stringify(n)}));case 4:e.prev=4,e.t0=e.catch(0),this.processError(e.t0);case 7:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"download",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callGapi(gapi.client.drive.files.get,{fileId:t,alt:"media"});case 2:return n=e.sent,e.abrupt("return",n.result||n.body);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createFile",value:function(){var e=Object(c.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callGapi(gapi.client.drive.files.create,{resource:{name:t,mimeType:"text/plain",parents:[n||"appDataFolder"]},fields:"id"});case 2:return a=e.sent,e.abrupt("return",a.result);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createFolder",value:function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callGapi(gapi.client.drive.files.create,{resource:{name:t,mimeType:"application/vnd.google-apps.folder",parents:["appDataFolder"]},fields:"id"});case 2:return n=e.sent,e.abrupt("return",n.result);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteFile",value:function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.callGapi(gapi.client.drive.files.delete,{fileId:t});case 3:return e.abrupt("return",!0);case 6:if(e.prev=6,e.t0=e.catch(0),404!==e.t0.status){e.next=10;break}return e.abrupt("return",!1);case 10:throw e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"loadGoogleAPI",value:function(){return new Promise((function(e,t){if(!window.gapi)return t("google api is not loaded");window.gapi.auth2&&e(window.gapi.auth2),window.gapi.load("auth2",(function(){return e(window.gapi.auth2)}))}))}},{key:"callGapi",value:function(e,t){return new Promise((function(n,a){return e(t).then((function(e){e&&(e.status<200||e.status>299)?(console.log("GAPI call returned bad status",e),a(e)):n(e)}),(function(e){return a(e)}))}))}},{key:"processError",value:function(e){console.error(e)}}]),e}(),k=n(2),y=function(){var e=new w,t=Object(k.f)(Object(c.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.isBooksLoading=!0,t.next=3,e.list('fileExtension="json"');case 3:i.books=t.sent,i.isBooksLoading=!1,console.log("cloud books",i.books);case 6:case"end":return t.stop()}}),t)})))),n=Object(k.f)(Object(c.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.signIn();case 2:i.isLoggedIn=e.isLoggedIn();case 3:case"end":return t.stop()}}),t)})))),a=Object(k.f)(Object(c.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.signOut();case 2:i.isLoggedIn=e.isLoggedIn(),i.books=[];case 4:case"end":return t.stop()}}),t)})))),r=Object(k.f)(function(){var t=Object(c.a)(o.a.mark((function t(n,a){var r,s,A,l,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.list('name="'.concat(n.name,'-text.html"'));case 2:if(!t.sent.length){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,Promise.all([e.createFile("".concat(n.name,"-meta.json")),e.createFile("".concat(n.name,"-text.html"))]);case 7:return r=t.sent,s=Object(v.a)(r,2),A=s[0],l=s[1],n.metaFileId=A.id,n.textFileId=l.id,t.next=15,Promise.all([e.upload(A.id,JSON.stringify(n)),e.upload(l.id,a)]);case 15:c={id:A.id,metaFileId:A.id,textFileId:l.id,name:"".concat(n.name,"-meta.json")},i.books.push(c);case 17:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),s=Object(k.f)(function(){var t=Object(c.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.metaFileId){t.next=3;break}return t.next=3,e.upload(n.metaFileId,JSON.stringify(n));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),A=Object(k.f)(function(){var t=Object(c.a)(o.a.mark((function t(n){var a,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.download(n.id);case 2:if(a=t.sent,r="",!a.textFileId){t.next=8;break}return t.next=7,e.download(a.textFileId);case 7:r=t.sent;case 8:return t.abrupt("return",{meta:a,text:r});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),l=Object(k.f)(function(){var t=Object(c.a)(o.a.mark((function t(n){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.deleteFile(n.id);case 2:return(a=t.sent)&&(i.books=i.books.filter((function(e){return e.id!==n.id}))),t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),i=Object(k.l)({books:[],isClientLoaded:!1,isLoggedIn:!1,isBooksLoading:!1,signInAction:n,signOutAction:a,uploadBookAction:r,syncMetaAction:s,downloadBookAction:A,deleteBookAction:l,fetchBooksListAction:t});return e.load().then((function(){i.isClientLoaded=!0,i.isLoggedIn=e.isLoggedIn()})).catch((function(e){console.error("error is",e)})),i},E=r.a.createContext({}),O=n(44),B=n.n(O),j=n(45),I=n.n(j),F=Object(u.a)((function(){var e=Object(a.useContext)(E),t=e.isClientLoaded,n=e.isLoggedIn,s=e.signInAction,A=e.signOutAction;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t?"auth-buttons":"hidden"},n?r.a.createElement("div",{className:"logout-button",onClick:A},r.a.createElement("span",null,"LogOut"),r.a.createElement("div",null,r.a.createElement("img",{src:I.a,alt:""}))):r.a.createElement("div",{className:"login-button",onClick:s},r.a.createElement("span",null,"LogIn"),r.a.createElement("div",null,r.a.createElement("img",{src:B.a,alt:""})))))})),D=Object(u.a)((function(e){var t=e.children,n=e.className,a=void 0===n?"":n;return r.a.createElement("header",{className:"header ".concat(a)},r.a.createElement("div",{className:"left-content"},r.a.createElement(g,null),r.a.createElement(h,null)),r.a.createElement("div",{className:"children"},t," "),r.a.createElement("div",{className:"right-content"},r.a.createElement(F,null)))})),N=n(17),P=n(52),L=Object(P.a)("library",1,{upgrade:function(e,t){t<1&&(e.createObjectStore("index",{keyPath:"id"}),e.createObjectStore("books",{autoIncrement:!0}))}}),M=function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L;case 2:return e.abrupt("return",e.sent.transaction(["index","books"],"readwrite"));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),q={getBookMeta:function(e){return Object(c.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L;case 2:return t.abrupt("return",t.sent.get("index",e));case 3:case"end":return t.stop()}}),t)})))()},getAllMeta:function(){return Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L;case 2:return e.abrupt("return",e.sent.getAll("index"));case 3:case"end":return e.stop()}}),e)})))()},getBookText:function(e){return Object(c.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L;case 2:return t.abrupt("return",t.sent.get("books",e));case 3:case"end":return t.stop()}}),t)})))()},addBook:function(e){var t=arguments;return Object(c.a)(o.a.mark((function n(){var a,r,s,A,l;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.length>1&&void 0!==t[1]?t[1]:"",r=Date.now(),n.next=4,M();case 4:return s=n.sent,n.next=7,s.objectStore("books").add(a);case 7:return A=n.sent,l=Object(N.a)(Object(N.a)({},e),{},{id:A,timestamp:r}),n.next=11,s.objectStore("index").add(l);case 11:return n.next=13,s.done;case 13:return n.abrupt("return",l);case 14:case"end":return n.stop()}}),n)})))()},setBookMeta:function(e,t){return Object(c.a)(o.a.mark((function n(){var a,r,s;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M();case 2:return a=n.sent,r=a.objectStore("index"),n.next=6,r.get(e);case 6:return s=n.sent,n.next=9,r.put(Object(N.a)(Object(N.a)({},s),t));case 9:return n.next=11,a.done;case 11:case"end":return n.stop()}}),n)})))()},delete:function(e){return Object(c.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M();case 2:return n=t.sent,t.next=5,n.objectStore("index").delete(e);case 5:return t.next=7,n.objectStore("books").delete(e);case 7:return t.next=9,n.done;case 9:case"end":return t.stop()}}),t)})))()},clear:function(){return Object(c.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:return t=e.sent,e.next=5,t.objectStore("index").clear();case 5:return e.next=7,t.objectStore("books").clear();case 7:return e.next=9,t.done;case 9:case"end":return e.stop()}}),e)})))()}};function T(e){var t,n=(new DOMParser).parseFromString(e,"text/xml"),a=(new window.DOMParser).parseFromString('<?xml version="1.0"?>\n<xsl:stylesheet\n        version="1.0"\n        xmlns:xsl="http://www.w3.org/1999/XSL/Transform"\n        xmlns:xlink="http://www.w3.org/1999/xlink"\n        xmlns:fb="http://www.gribuser.ru/xml/fictionbook/2.0"\n        >\n    <xsl:output\n            media-type="text/html"\n            method="html"\n            encoding="utf-8"\n            omit-xml-declaration="yes"\n            doctype-public="HTML5"\n            />\n\n    <xsl:key name="note-link" match="fb:section" use="@id"/>\n    <xsl:template match="/*">\n        <div class="text">\n            <xsl:for-each select="fb:description/fb:title-info/fb:coverpage/fb:image">\n                <xsl:call-template name="image"/>\n            </xsl:for-each>\n\n            <xsl:for-each select="fb:description/fb:title-info/fb:annotation">\n                <section class="text-annotation">\n                    <xsl:call-template name="annotation"/>\n                </section>\n            </xsl:for-each>\n\n            \x3c!--<navMap style="display: none;">--\x3e\n                \x3c!--<xsl:apply-templates select="fb:body" mode="toc"/>--\x3e\n            \x3c!--</navMap>--\x3e\n\n\n            <xsl:for-each select="fb:body">\n                <xsl:if test="position() != 1">\n                    <div class="separator"></div>\n                </xsl:if>\n\n                \x3c!--<xsl:if test="not(fb:title) and @name">--\x3e\n                    \x3c!--<h4 align="center">--\x3e\n                        \x3c!--<xsl:value-of select="@name"/>--\x3e\n                    \x3c!--</h4>--\x3e\n                \x3c!--</xsl:if>--\x3e\n\n                <div class="text-wrapper">\n                    <xsl:apply-templates/>\n                </div>\n\n            </xsl:for-each>\n        </div>\n    </xsl:template>\n    \x3c!-- author template --\x3e\n    <xsl:template name="author">\n        <xsl:value-of select="fb:first-name"/>\n        <xsl:text disable-output-escaping="no">&#032;</xsl:text>\n        <xsl:value-of select="fb:middle-name"/>&#032;\n        <xsl:text disable-output-escaping="no">&#032;</xsl:text>\n        <xsl:value-of select="fb:last-name"/>\n        <br/>\n    </xsl:template>\n    \x3c!-- secuence template --\x3e\n    <xsl:template name="sequence">\n        <xsl:value-of select="@name"/>\n        <xsl:if test="@number">\n            <xsl:text disable-output-escaping="no">,&#032;#</xsl:text>\n            <xsl:value-of select="@number"/>\n        </xsl:if>\n        <xsl:if test="fb:sequence">\n            <ul>\n                <xsl:for-each select="fb:sequence">\n                    <xsl:call-template name="sequence"/>\n                </xsl:for-each>\n            </ul>\n        </xsl:if>\n    </xsl:template>\n    \x3c!-- toc template --\x3e\n    <xsl:template match="fb:section|fb:body" mode="toc">\n        <xsl:choose>\n            <xsl:when test="name()=\'body\' and position()=1 and not(fb:title)">\n                <xsl:apply-templates select="fb:section" mode="toc"/>\n            </xsl:when>\n            <xsl:otherwise>\n                <navPoint>\n                    <navLabel>\n                        <text>\n                            <xsl:value-of select="normalize-space(fb:title | @name)"/>\n                        </text>\n                    </navLabel>\n                    <content src="#TOC_{generate-id()}"></content>\n                    \x3c!--<xsl:value-of select="normalize-space(fb:title | //fb:body/@name)"/>--\x3e\n                    \x3c!--<xsl:value-of select="normalize-space(fb:body[@name == \'notes\']/@name | fb:body/title)"/>--\x3e\n\n                    \x3c!-- fb:body[@name = \'notes\'] --\x3e\n                    <xsl:if test="fb:section">\n                        <navPoint>\n                            <xsl:apply-templates select="fb:section" mode="toc"/>\n                        </navPoint>\n                    </xsl:if>\n                </navPoint>\n            </xsl:otherwise>\n        </xsl:choose>\n    </xsl:template>\n    \x3c!-- description --\x3e\n    <xsl:template match="fb:description">\n        <xsl:apply-templates/>\n    </xsl:template>\n    \x3c!-- body --\x3e\n    <xsl:template match="fb:body">\n        <div>\n            <xsl:apply-templates/>\n        </div>\n    </xsl:template>\n\n    <xsl:template match="fb:section">\n        <section>\n            <xsl:attribute name="class">\n                <xsl:text>default-section</xsl:text>\n                <xsl:if test="starts-with(translate(fb:title, \'\u0413\u041b\u0410\u0412\u0410\', \'\u0433\u043b\u0430\u0432\u0430\'), \'\u0433\u043b\u0430\u0432\u0430\')">\n                    <xsl:text> chapter</xsl:text>\n                </xsl:if>\n            </xsl:attribute>\n            <a name="TOC_{generate-id()}"></a>\n            <xsl:if test="@id">\n                <xsl:element name="a">\n                    <xsl:attribute name="name">\n                        <xsl:value-of select="@id"/>\n                    </xsl:attribute>\n                </xsl:element>\n            </xsl:if>\n            <xsl:apply-templates/>\n        </section>\n    </xsl:template>\n    <xsl:template match="fb:body[@name=\'notes\']//fb:section">\n        <div>\n            <xsl:if test="@id">\n                <xsl:attribute name="class">\n                    <xsl:value-of select="\'annotation\'"/>\n                </xsl:attribute>\n            </xsl:if>\n            <a name="TOC_{generate-id()}"></a>\n            <xsl:if test="@id">\n                <xsl:element name="a">\n                    <xsl:attribute name="name">\n                        <xsl:value-of select="@id"/>\n                    </xsl:attribute>\n                </xsl:element>\n            </xsl:if>\n            <xsl:apply-templates/>\n        </div>\n    </xsl:template>\n\n\n    \x3c!-- section/title --\x3e\n    <xsl:template match="fb:section/fb:title|fb:poem/fb:title">\n        <xsl:choose>\n            <xsl:when test="count(ancestor::node()) &lt; 9">\n                <xsl:element name="{concat(\'h\',count(ancestor::node())-3)}">\n                    <a name="TOC_{generate-id()}"></a>\n                    <xsl:if test="@id">\n                        <xsl:element name="a">\n                            <xsl:attribute name="name">\n                                <xsl:value-of select="@id"/>\n                            </xsl:attribute>\n                        </xsl:element>\n                    </xsl:if>\n                    <xsl:apply-templates/>\n                </xsl:element>\n            </xsl:when>\n            <xsl:otherwise>\n                <xsl:element name="h6">\n                    <xsl:if test="@id">\n                        <xsl:element name="a">\n                            <xsl:attribute name="name">\n                                <xsl:value-of select="@id"/>\n                            </xsl:attribute>\n                        </xsl:element>\n                    </xsl:if>\n                    <xsl:apply-templates/>\n                </xsl:element>\n            </xsl:otherwise>\n        </xsl:choose>\n    </xsl:template>\n    \x3c!-- section/title --\x3e\n    <xsl:template match="fb:body/fb:title">\n        \x3c!--<h1 style="display: none;">--\x3e\n            \x3c!--<xsl:apply-templates mode="title"/>--\x3e\n        \x3c!--</h1>--\x3e\n    </xsl:template>\n    <xsl:template match="fb:body[@name=\'notes\']/fb:title">\n        <h1>\n            <xsl:apply-templates mode="title"/>\n        </h1>\n    </xsl:template>\n\n    <xsl:template match="fb:title/fb:p">\n        <xsl:apply-templates/>\n        <xsl:text disable-output-escaping="no">&#032;</xsl:text>\n        <br/>\n    </xsl:template>\n    \x3c!-- subtitle --\x3e\n    <xsl:template match="fb:subtitle">\n        <xsl:if test="@id">\n            <xsl:element name="a">\n                <xsl:attribute name="name">\n                    <xsl:value-of select="@id"/>\n                </xsl:attribute>\n            </xsl:element>\n        </xsl:if>\n        <h5>\n            <xsl:apply-templates/>\n        </h5>\n    </xsl:template>\n    \x3c!-- p --\x3e\n    <xsl:template match="fb:p">\n        \x3c!--<xsl:if test"preceding-sibling::*[1][name()] != \'fb:image\'">--\x3e\n            <p data-id="pos_{generate-id()}">\n                <xsl:if test="@id">\n                    <xsl:element name="a">\n                        <xsl:attribute name="name">\n                            <xsl:value-of select="@id"/>\n                        </xsl:attribute>\n                    </xsl:element>\n                </xsl:if>\n                <xsl:apply-templates/>\n            </p>\n        \x3c!--</xsl:if>--\x3e\n    </xsl:template>\n    \x3c!-- strong --\x3e\n    <xsl:template match="fb:strong">\n        <b>\n            <xsl:apply-templates/>\n        </b>\n    </xsl:template>\n    \x3c!-- emphasis --\x3e\n    <xsl:template match="fb:emphasis">\n        <i>\n            <xsl:apply-templates/>\n        </i>\n    </xsl:template>\n    \x3c!-- style --\x3e\n    <xsl:template match="fb:style">\n        <span class="{@name}">\n            <xsl:apply-templates/>\n        </span>\n    </xsl:template>\n    \x3c!-- empty-line --\x3e\n    <xsl:template match="fb:empty-line">\n        <xsl:if test="following-sibling::*[1] != fb:image">\n            <br/>\n        </xsl:if>\n    </xsl:template>\n    \x3c!-- link --\x3e\n    <xsl:template match="fb:a">\n        <xsl:choose>\n            <xsl:when test="starts-with(@xlink:href,\'#\')">\n                <xsl:element name="a">\n                    <xsl:attribute name="class">\n                        <xsl:value-of select="\'footnote\'"/>\n                    </xsl:attribute>\n                    <xsl:attribute name="href">\n                        <xsl:value-of select="@xlink:href"/>\n                    </xsl:attribute>\n                    <xsl:attribute name="title">\n                        <xsl:value-of select="key(\'note-link\',substring-after(@xlink:href,\'#\'))/fb:p"/>\n                    </xsl:attribute>\n                    <xsl:choose>\n                        <xsl:when test="(@type) = \'note\'">\n                            <sup>\n                                <xsl:apply-templates/>\n                            </sup>\n                        </xsl:when>\n                        <xsl:otherwise>\n                            <xsl:apply-templates/>\n                        </xsl:otherwise>\n                    </xsl:choose>\n                </xsl:element>\n            </xsl:when>\n            <xsl:otherwise>\n                <xsl:element name="span">\n                    <xsl:choose>\n                        <xsl:when test="(@type) = \'note\'">\n                            <sup>\n                                <xsl:apply-templates/>\n                            </sup>\n                        </xsl:when>\n                        <xsl:otherwise>\n                            <xsl:apply-templates/>\n                        </xsl:otherwise>\n                    </xsl:choose>\n                </xsl:element>\n            </xsl:otherwise>\n        </xsl:choose>\n    </xsl:template>\n    \x3c!-- annotation --\x3e\n    <xsl:template name="annotation">\n        <xsl:if test="@id">\n            <xsl:element name="a">\n                <xsl:attribute name="name">\n                    <xsl:value-of select="@id"/>\n                </xsl:attribute>\n            </xsl:element>\n        </xsl:if>\n        <xsl:apply-templates/>\n    </xsl:template>\n    \x3c!-- epigraph --\x3e\n    <xsl:template match="fb:epigraph">\n        <blockquote class="epigraph">\n            <xsl:if test="@id">\n                <xsl:element name="a">\n                    <xsl:attribute name="name">\n                        <xsl:value-of select="@id"/>\n                    </xsl:attribute>\n                </xsl:element>\n            </xsl:if>\n            <xsl:apply-templates/>\n        </blockquote>\n    </xsl:template>\n    \x3c!-- epigraph/text-author --\x3e\n    <xsl:template match="fb:epigraph/fb:text-author">\n        <blockquote class="author">\n            <i>\n                <xsl:apply-templates/>\n            </i>\n        </blockquote>\n    </xsl:template>\n    \x3c!-- cite --\x3e\n    <xsl:template match="fb:cite">\n        <blockquote>\n            <xsl:if test="@id">\n                <xsl:element name="a">\n                    <xsl:attribute name="name">\n                        <xsl:value-of select="@id"/>\n                    </xsl:attribute>\n                </xsl:element>\n            </xsl:if>\n            <xsl:apply-templates/>\n        </blockquote>\n    </xsl:template>\n    \x3c!-- cite/text-author --\x3e\n    <xsl:template match="fb:text-author">\n        <blockquote>\n            <i>\n                <xsl:apply-templates/>\n            </i>\n        </blockquote>\n    </xsl:template>\n    \x3c!-- date --\x3e\n    <xsl:template match="fb:date">\n        <xsl:choose>\n            <xsl:when test="not(@value)">\n                &#160;&#160;&#160;\n                <xsl:apply-templates/>\n                <br/>\n            </xsl:when>\n            <xsl:otherwise>\n                &#160;&#160;&#160;<xsl:value-of select="@value"/>\n                <br/>\n            </xsl:otherwise>\n        </xsl:choose>\n    </xsl:template>\n    \x3c!-- poem --\x3e\n    <xsl:template match="fb:poem">\n        <blockquote>\n            <xsl:if test="@id">\n                <xsl:element name="a">\n                    <xsl:attribute name="name">\n                        <xsl:value-of select="@id"/>\n                    </xsl:attribute>\n                </xsl:element>\n            </xsl:if>\n            <xsl:apply-templates/>\n        </blockquote>\n    </xsl:template>\n\n    \x3c!-- stanza --\x3e\n    <xsl:template match="fb:stanza">\n        <xsl:apply-templates/>\n        <br/>\n    </xsl:template>\n    \x3c!-- v --\x3e\n    <xsl:template match="fb:v">\n        <xsl:if test="@id">\n            <xsl:element name="a">\n                <xsl:attribute name="name">\n                    <xsl:value-of select="@id"/>\n                </xsl:attribute>\n            </xsl:element>\n        </xsl:if>\n        <xsl:apply-templates/>\n        <br/>\n    </xsl:template>\n    \x3c!-- image --\x3e\n    <xsl:template match="fb:image" name="image">\n        <div>\n            <xsl:choose>\n                <xsl:when test="ancestor::fb:coverpage">\n                    <xsl:attribute name="class">\n                        <xsl:value-of select="\'text-cover\'"/>\n                    </xsl:attribute>\n                </xsl:when>\n                <xsl:otherwise>\n                    <xsl:attribute name="class">\n                        <xsl:text>default image</xsl:text>\n                    </xsl:attribute>\n                </xsl:otherwise>\n            </xsl:choose>\n            <div class="image-wrapper">\n                <img>\n                    <xsl:choose>\n                        <xsl:when test="starts-with(@xlink:href,\'#\')">\n                            <xsl:attribute name="src">\n                                <xsl:text>data:</xsl:text>\n                                <xsl:variable name="href" select="substring-after(@xlink:href,\'#\')"/>\n                                <set variable="href" expression="substring-after(@xlink:href,\'#\')"/>\n                                <xsl:value-of select="//fb:binary[@id=$href]/@content-type" disable-output-escaping="yes"/><xsl:text>;base64,</xsl:text>\n                                \x3c!--<xsl:value-of select="substring-after(@xlink:href,\'#\')"/>--\x3e\n                                <xsl:value-of select="//fb:binary[@id=$href]" disable-output-escaping="yes"/>\n                            </xsl:attribute>\n\n                        </xsl:when>\n                        <xsl:otherwise>\n                            <xsl:attribute name="src">\n                                <xsl:value-of select="@xlink:href"/>\n                            </xsl:attribute>\n                        </xsl:otherwise>\n                    </xsl:choose>\n                </img>\n            </div>\n            <xsl:if test="following-sibling::node()[1]/fb:emphasis">\n                <div class="image-annotation">\n                    <xsl:apply-templates select="following-sibling::fb:p[1]"/>\n                </div>\n            </xsl:if>\n        </div>\n    </xsl:template>\n</xsl:stylesheet>',"text/xml"),r=new XSLTProcessor;r.importStylesheet(a);var s=r.transformToDocument(n),A=(null===(t=s.querySelector(".text-cover img"))||void 0===t?void 0:t.getAttribute("src"))||"";return{documentBody:s.body.innerHTML,cover:A}}var U=function(){var e=Object(k.f)(Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.getAllMeta();case 2:i.books=e.sent,console.log("books",i.books);case 4:case"end":return e.stop()}}),e)})))),t=Object(k.f)(function(){var e=Object(c.a)(o.a.mark((function e(t,n){var a,r,s,A,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=T(t),r=a.documentBody,s=a.cover,A={name:n.name,cover:s},i.isAddingBookInProcess=!0,e.next=5,q.addBook(A,r);case 5:l=e.sent,i.books.push(l),i.isAddingBookInProcess=!1;case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),n=Object(k.f)(function(){var e=Object(c.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.addBook(t,n);case 2:a=e.sent,i.books.push(a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),a=Object(k.f)(function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.delete(t.id);case 2:n=i.books.indexOf(t),i.books.splice(n,1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r=Object(k.f)(function(){var e=Object(c.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.setBookMeta(t,{positionElement:n});case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),s=Object(k.f)(function(){var e=Object(c.a)(o.a.mark((function e(t,n){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=i.books.find((function(e){return e.id===t})))&&Object.assign(a,n),e.next=4,q.setBookMeta(t,n);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),A=Object(k.f)(function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.currentBook.meta.id!==t){e.next=5;break}return e.next=3,q.getBookMeta(t);case 3:return i.currentBook.meta=e.sent,e.abrupt("return",Promise.resolve());case 5:return e.abrupt("return",Promise.all([q.getBookMeta(t),q.getBookText(t)]).then((function(e){i.currentBook.meta=e[0],i.currentBook.text=e[1]})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),l=Object(k.f)(function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q.getBookText(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i=Object(k.l)({books:[],remoteBooks:[],currentBook:{meta:{},text:""},isAddingBookInProcess:!1,fetchBooksListAction:e,fetchBookTextAction:l,addBookAction:t,openBookAction:A,syncBookAction:n,deleteBookAction:a,updateBookAction:s,updateBookPositionAction:r});return i},z=r.a.createContext({});n(74);function Y(e){var t=e.loading,n=e.children;return console.log("chi",n),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:t?"loading":"hidden"},r.a.createElement("div",null,"Loading")),n)}var X=Object(u.a)((function(){var e=Object(a.useContext)(E),t=e.books,n=e.isBooksLoading,s=e.isLoggedIn,A=e.downloadBookAction,l=e.deleteBookAction,i=Object(a.useContext)(z),u=i.books,f=i.updateBookAction,x=i.syncBookAction,p=function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t);case 2:if(!e.sent){e.next=9;break}if(!(n=u.find((function(e){return e.metaFileId===t.metaFileId})))){e.next=9;break}return delete n.metaFileId,e.next=9,f(n.id,{metaFileId:null});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(c.a)(o.a.mark((function e(t){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t);case 2:return n=e.sent,a=n.meta,r=n.text,e.next=7,x(a,r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"collection ".concat(s?"":"hidden")},r.a.createElement(Y,{loading:n},t.map((function(e,t){return r.a.createElement("div",{key:e.id},r.a.createElement("div",null,e.id,": ",e.name),r.a.createElement("button",{onClick:function(){return p(e)}},"del"),r.a.createElement("button",{onClick:function(){return m(e)}},"collect"))})))))}));var G=n(46),H=n.n(G),W=Object(u.a)((function(e){var t=Object.assign({},e),n=Object(a.useContext)(z).addBookAction;return r.a.createElement("div",t,r.a.createElement("label",{className:"add-book-lable",htmlFor:"btn-add-book"},r.a.createElement("img",{src:H.a,alt:""}),r.a.createElement("input",{type:"file",name:"",id:"btn-add-book",onChange:function(e){var t;if(null===(t=e.target.files)||void 0===t?void 0:t.length){var a=e.target.files[0];(function(e){var t=new FileReader;return new Promise((function(n,a){t.onload=function(e){var t;return n((null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.result)+"")},t.onerror=function(e){return a("error reading file")},t.readAsText(e)}))})(a).then((function(e){n(e,a)}))}},accept:".fb2"})))})),S=Object(u.a)((function(){return r.a.createElement("div",{className:"book-list-placeholder"},r.a.createElement("div",{className:"centered"},r.a.createElement("div",null,"Welcome! You haven't uploaded any books yet. Careful Reader supports",r.a.createElement("strong",null,"\xa0fb2\xa0"),"ones."),r.a.createElement(W,{className:"add-btn-placeholder"})))})),J=n(53),K=(n(75),Object(u.a)((function(e){var t=e.book,n=e.children,a=e.to,s=Object(J.a)(e,["book","children","to"]);return r.a.createElement("div",null,n,r.a.createElement(x.b,Object.assign({to:a,className:"book-item"},s),t.cover?r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{src:t.cover,alt:""})):r.a.createElement("div",{className:"name"},t.name)))}))),R=Object(u.a)((function(){var e=Object(a.useContext)(z),t=e.books,n=e.isAddingBookInProcess;return r.a.createElement(r.a.Fragment,null,t.length?r.a.createElement("div",{className:"collection"},r.a.createElement(Y,{loading:n},t.map((function(e,t){return r.a.createElement(K,{book:e,key:e.id,to:"/details/".concat(e.id)})})))):r.a.createElement(S,null))})),V=Object(u.a)((function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(D,null),r.a.createElement("div",{className:"book-shelf"},r.a.createElement("div",{className:"container"},r.a.createElement(X,null),r.a.createElement("div",null," separator "),r.a.createElement(R,null)),r.a.createElement(W,{className:"add-button-fixed"})))})),Z=(n(76),n(51));function _(e){var t=Object(Z.a)(Array(100).keys()).sort((function(){return Math.random()-.5})),n=0,a=e.split(" ").map((function(e){return'<span class="w'.concat(t[n=n>=100?0:n+1],'">').concat(e,"</span>")})).join(" "),r=document.createElement("hlw");return r.innerHTML=a,r}function $(e){e.className.includes("hg")||function(e){for(var t,n=[],a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);t=a.nextNode();)n.push(t);return n}(e).forEach((function(t){if(t){var n=_(t.textContent);t.replaceWith(n),e.className+=" hg"}}))}function ee(e,t){var n=t.scrollTop,a=t.clientHeight,r=n+a,s=e.offsetTop,A=e.clientHeight,l=s+A;return s>=n&&s<r||l>n&&l<=r||A>a&&s<=n&&l>=r}var te=n(47),ne=function(e,t){var n=null;return function(){for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];null!==n&&(clearTimeout(n),n=null),n=setTimeout((function(){return e.apply(void 0,r)}),t)}}((function(e){return e&&e()}),100),ae=Object(u.a)((function(){var e=Object(a.useContext)(z),t=e.updateBookPositionAction,n=e.openBookAction,s=e.currentBook,A=Object(a.useState)(0),l=Object(v.a)(A,2),u=l[0],x=l[1],p=Object(a.useState)("0.0"),m=Object(v.a)(p,2),d=m[0],b=m[1],g=Object(a.useState)(0),h=Object(v.a)(g,2),C=h[0],Q=h[1],w=Object(a.useState)(!0),k=Object(v.a)(w,2),y=k[0],E=k[1],O=Object(a.useState)(!1),B=Object(v.a)(O,2),j=B[0],I=B[1],F=Object(a.useState)(!1),N=Object(v.a)(F,2),P=N[0],L=N[1],M=Object(a.useRef)(null),q=Object(a.useRef)([]),T=Object(a.useState)(!1),U=Object(v.a)(T,2),X=U[0],G=U[1],H=Object(f.h)(),W=parseInt(H.bookId),S=Object(a.useState)({}),J=Object(v.a)(S,2),K=J[0],R=J[1];return Object(a.useEffect)((function(){var e=M.current;return function(){var t=Object(c.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return G(!0),t.next=3,n(W);case 3:e.innerHTML=s.text,q.current=V(),Q(ae()),_(),G(!1);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()(),e.addEventListener("scroll",Z),function(){return e.removeEventListener("scroll",Z)}}),[]),Object(te.a)("deviceorientation",(function(e){var t=e.gamma;if(j){if(t){var n={transform:"rotateZ(".concat(-t,"deg)")};R(n)}}else R({transform:""})})),r.a.createElement("div",{className:"reader"},r.a.createElement(D,{className:"".concat(P?"":" hidden"," p-fixed z-max")},r.a.createElement("div",null,r.a.createElement(i,{label:"highlight",value:y,onChange:function(){E(!y)}}),r.a.createElement(i,{label:"dto",value:j,onChange:function(){I(!j)}})),r.a.createElement("div",{className:""},d,"%"),r.a.createElement("div",{className:"pages"},u," / ",C)),r.a.createElement(Y,{loading:X},r.a.createElement("div",{className:"list-view ".concat(y?"highlight":"")},r.a.createElement("div",{className:"text-container",onClick:function(){L(!P)},style:K,ref:M}))));function V(){var e=[];return document.querySelectorAll("p").forEach((function(t){e.push(t)})),e.sort((function(e,t){return e.offsetTop>t.offsetTop}))}function Z(e){var n=M.current,a=q.current;if(n){var r=function(){var e=M.current;return e?100*e.scrollTop/e.scrollHeight:0}();b(r.toFixed(2)),x(function(){var e=M.current;return Math.round(e.scrollTop/e.clientHeight)}()),ne((function(){!function(e){if(e){var n=e.getAttribute("data-id");t(W,n)}}((function(e,t){var n=[];if(!e)return n;for(var a=e.scrollTop+e.clientHeight,r=0;r<t.length;r++){var s=t[r];if(ee(s,e)&&($(s),n.push(s)),s.offsetTop>a)break}return n}(n,a)||[])[0])}))}}function _(){if(s.meta){var e=document.querySelector('[data-id="'.concat(s.meta.positionElement,'"]'));null===e||void 0===e||e.scrollIntoView()}}function ae(){var e=M.current;return Math.round(e.scrollHeight/e.clientHeight)}})),re=n(83),se=n(48),Ae=n.n(se),le=(n(77),n(16));var oe=Object(u.a)(Object(le.c)((function(e){var t=e.intl,n=Object(a.useContext)(z).currentBook.meta;return r.a.createElement("div",{className:"feed"},r.a.createElement(D,null),r.a.createElement("div",{className:"content"},n.id&&r.a.createElement("section",{className:"current-book"},r.a.createElement("span",{className:"title"},t.formatMessage({id:"toRead"})),r.a.createElement(K,{book:n,to:"/read/".concat(n.id)})),r.a.createElement("section",{className:"link-to-shelves"},r.a.createElement("span",{className:"title"},t.formatMessage({id:"library"})),r.a.createElement(x.b,{to:"/shelves"},r.a.createElement("img",{src:Ae.a,alt:"shelve"})))))}))),ce=(n(78),Object(u.a)((function(){var e=Object(f.h)(),t=parseInt(e.bookId),n=Object(a.useContext)(z),s=n.books,A=n.updateBookAction,l=n.deleteBookAction,i=n.fetchBookTextAction,u=Object(a.useContext)(E),x=u.uploadBookAction,p=u.syncMetaAction,m=Object(a.useState)(),d=Object(v.a)(m,2),b=d[0],g=d[1];Object(a.useEffect)((function(){var e=s.find((function(e){return e.id===t}));g(e)}),[s,t]);var h=function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t.id);case 2:return n=e.sent,e.next=5,x(t,n);case 5:return e.sent,console.log("after download",t),e.next=9,A(t.id,Object(N.a)({},t));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(c.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.metaFileId){e.next=5;break}return e.next=3,p(t);case 3:e.next=11;break;case 5:return e.next=7,i(t.id);case 7:return n=e.sent,e.next=10,x(t,n);case 10:e.sent;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"details"},r.a.createElement(D,null),b&&r.a.createElement("section",{className:"content"},r.a.createElement("div",null,b.name),r.a.createElement(K,{book:b,to:"/read/".concat(b.id)}),r.a.createElement("div",{className:"info"},r.a.createElement("div",{className:"controls"},r.a.createElement("button",{onClick:function(){return Q(b)}},"sync "),r.a.createElement("button",{onClick:function(){return h(b)}},"upload"),r.a.createElement("button",{onClick:function(){C(b)}},"del"),r.a.createElement("button",null,"info"),r.a.createElement("div",null),r.a.createElement("div",null,b.metaFileId)))))}))),ie=n(31),ue=n(22),fe=Object(ue.a)({library:{id:"feed.library",defaultMessage:"library"},toRead:{id:"feed.to-read",defaultMessage:"to read..."},close:{id:"feed.close",defaultMessage:"close..."}}),xe=n(8),pe=function(){var e=Object(xe.c)(),t=(Object(ie.a)({locale:"en"},e),Object(ie.a)({locale:"ru"},e),Object(k.f)((function(e){n.locale=e}))),n=Object(k.l)({locale:"en",setLocale:t});return n},me=r.a.createContext({}),de=Object(u.a)((function(){var e=Object(re.a)(U),t=Object(re.a)(y),n=Object(re.a)(pe),s=t.isLoggedIn;Object(a.useEffect)((function(){e.fetchBooksListAction()}),[]);var A=function(){var e=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=3;break}return e.next=3,t.fetchBooksListAction();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){A()}),[s]),console.log("messages",fe),r.a.createElement(me.Provider,{value:n},r.a.createElement(z.Provider,{value:e},r.a.createElement(E.Provider,{value:t},r.a.createElement(ie.b,{locale:n.locale,defaultLocale:"en"},r.a.createElement(x.a,{basename:"/careful-reader"},r.a.createElement(f.c,null,r.a.createElement(f.a,{exact:!0,path:"/"},r.a.createElement(oe,null)),r.a.createElement(f.a,{exact:!0,path:"/read/:bookId"},r.a.createElement(ae,null)),r.a.createElement(f.a,{exact:!0,path:"/details/:bookId"},r.a.createElement(ce,null)),r.a.createElement(f.a,{exact:!0,path:"/shelves"},r.a.createElement(V,null))))))))})),be=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ge(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(79);var he=r.a.createElement(de,null);A.a.render(he,document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/careful-reader",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/careful-reader","/service-worker.js");be?(!function(e,t){fetch(e).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ge(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ge(t,e)}))}}()}},[[60,1,2]]]);
//# sourceMappingURL=main.6d089b5b.chunk.js.map